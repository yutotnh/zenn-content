---
title: "VS Codeの日本語編集を便利にする拡張機能(Word Divider)を作ってみた"
emoji: "🎏"
type: "tech"
topics:
  - "vscode"
  - "vscodeextension"
published: true
published_at: "2024-01-20 6:00"
---

## はじめに

[本拡張機能]((https://marketplace.visualstudio.com/items?itemName=yutotnh.word-divider))を使うと、下記画像のようにVS Codeで日本語の単語間移動ができるようになります。

![Japanese Word Handlerの動作イメージ](/images/b1ff5ac92ac811/examples-japanese-word-handler.gif)

## 開発の背景

私はソースコードだけでなくドキュメントもVS Codeで書くことが多いです。

しかし、VS Codeで日本語を編集する際に`Ctrl + →`や`Ctrl + ←`で単語の先頭や末尾に移動しようとすると、日本語の単語を区切りとして扱ってくれません。

一方、ブラウザのテキストエリアで日本語を編集するときに`Ctrl + →`や`Ctrl + ←`で単語の先頭や末尾に移動しようとすると、単語間をきちんと移動してくれます。

似たようなことを実現した拡張機能として[Japanese Word Handler](https://marketplace.visualstudio.com/items?itemName=sgryjp.japanese-word-handler)がありますが、こちらは単語ではなくひらがなやカタカナ、漢字で区切るため少し使い勝手が悪いです。

そこでVS Codeでもブラウザでの単語間移動と同じようなことが実現できないかなと思い、拡張機能([Word Divider](https://marketplace.visualstudio.com/items?itemName=yutotnh.word-divider))を作ってみました。

@[card](https://marketplace.visualstudio.com/items?itemName=yutotnh.word-divider)

## 動作イメージ

### Word Dividerの場合

![Word Dividerの動作イメージ](/images/b1ff5ac92ac811/examples.gif)

### 【参考】Japanese Word Handlerの場合

同じテキストで、Japanese Word Handlerを使った場合は以下のようになります。

Word Dividerでは`拡張機能`を`拡張`と`機能`に分割していたり、`使うと`を`使う`と`と`と分割しているのに対して、Japanese Word Handlerでは`拡張機能`を`拡張機能`、`使うと`を`使`と`うと`として扱っていることがわかります。

![Japanese Word Handlerの動作イメージ](/images/b1ff5ac92ac811/examples-japanese-word-handler.gif)

## 実装

単語の分割は[`Intl.Segmenter`](https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Intl/Segmenter)を利用しています。

もうこれがこの拡張機能のすべてといっても過言ではありません。

あとは、VS Codeの`Ctrl + →`や`Ctrl + ←`のキーバインドの挙動を拡張機能でも同じように実装するだけです。

リポジトリは[yutotnh/word-divider](https://github.com/yutotnh/word-divider)です。

@[card](https://github.com/yutotnh/word-divider)

## まとめ

今までVS Codeで日本語を編集するときに気になっていた点を解決できてかなり満足しています。

もし同じような悩みを持っている方がいましたら、ぜひお試しください。
